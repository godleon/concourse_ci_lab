platform: linux

image_resource:
  type: docker-image
  source:
    repository: rallyforge/rally
    tag: latest

inputs:
- name: git_osp
- name: rally_test
- name: rally_result
- name: git_semver

outputs:
- name: rally_output

run:
  path: sh
  args:
  - -exc
  - |
    ENTRY_PATH=$(pwd)
    RESOURCE_VER=$(cat git_semver/version)
    
    whoami
    env
  
    sudo apt-get update
    sudo apt-get -y install git

    cd ${HOME}
    bash ${ENTRY_PATH}/git_osp/09.rally/scripts/run_test.sh